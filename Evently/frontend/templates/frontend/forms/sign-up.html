{% extends "frontend/forms/baseForm.html" %}

{% load static %}

{% block title %}Реєстрація{% endblock %}

{% block formbox %}
  <div class="form--container">
    <div class="box">
      <a class="box__cross-link" href="/"><img class="box__cross-img" src=" {% static 'frontend/assets/icons/icon-close-2x.png' %} " alt="cross"></a>

      <h1 class="box__title">Реєстрація</h1>

      <form class="form" action="submit" method="post" id="registerForm">
        <div class="form_filds">
          <div class="form__fild">
            <label class="form__lable" for="first_name">Введіть ім'я</label>
            <input
              class="form__input" type="text" id="first_name" name="first_name" placeholder="Наприклад: Ім’я Прізвище" required/>
          </div>
          <div class="form__fild">
            <label class="form__lable" for="last_name">Введіть прізвище</label>
            <input
              class="form__input" type="text" id="last_name" name="last_name" placeholder="Наприклад: Ім’я Прізвище" required/>
          </div>
          <div class="form__fild">
            <label class="form__lable" for="email">Email</label>
            <input class="form__input" type="email" id="email" name="email" placeholder="Наприклад: example@some.com" required
            />
          </div>
          <div class="form__fild">
            <label class="form__lable" for="pass">Пароль</label>
            <input class="form__input" type="password" id="pass" name="pass" placeholder="Наприклад: c98hfghjGFDdsg_&i8g" required
            />
          </div>
          <div class="form__fild">
            <label class="form__lable" for="pass">Повторити пароль</label>
            <input class="form__input" type="password" id="pass" name="pass" placeholder="Наприклад: c98hfghjGFDdsg_&i8g" required
            />
          </div>
        </div>

        <button class="form__btn" type="submit" id="log-up">Зареєструватися</button>
      </form>

      <p class="box__bottom-lable">
        В мене вже є акаунт: <a class="box__bottom-link" href="/log-in">Увійти</a>
      </p>
    </div>
  </div>

  
  <script>
    document
      .getElementById("registerForm")
      .addEventListener("submit", async function (event) {
        event.preventDefault();

        let first_name = document.getElementById("first_name").value;
        let last_name = document.getElementById("last_name").value;
        let email = document.getElementById("email").value;
        let password = document.getElementById("password").value;

        let response = await fetch("/api/register/", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ first_name, last_name, email, password }),
        });

        let result = await response.json();
        document.getElementById("responseMessage").textContent =
          result.message || JSON.stringify(result);
      });
  </script>
{% endblock %}
